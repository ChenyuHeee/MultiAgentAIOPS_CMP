# OpenRCA（heuristic 适配层）结果记录

## Smoke（phase1，limit=20）

- submission: `cmp/OpenRCA/outputs/submissions/openrca_heuristic_phase1_pre30_smoke20.jsonl`
- Judge（离线，指向本机缓存 sentence-transformers 快照）输出：
  - LA: 1.42%
  - TA: 6.16%
  - Explainability: 2.99%
  - Efficiency: 100.00%
  - Final Score: 13.33

## Full（phase1）

- submission: `cmp/OpenRCA/outputs/submissions/openrca_heuristic_phase1_pre30_full_v2.jsonl`
- report: `cmp/OpenRCA/outputs/reports/openrca_heuristic_phase1_pre30_full_v2_report.json`
- Judge（离线，指向本机缓存 sentence-transformers 快照）输出：
  - LA: 24.17%
  - TA: 100.00%
  - Explainability: 53.29%
  - Efficiency: 100.00%
  - Final Score: 65.00

## Full（phase2）

- submission: `cmp/OpenRCA/outputs/submissions/openrca_heuristic_phase2_pre30_full_v2.jsonl`
- report: `cmp/OpenRCA/outputs/reports/openrca_heuristic_phase2_pre30_full_v2_report.json`
- Judge（离线，指向本机缓存 sentence-transformers 快照）输出：
  - LA: 19.27%
  - TA: 98.44%
  - Explainability: 45.76%
  - Efficiency: 100.00%
  - Final Score: 61.66

## 总评（phase12）

- submission: `cmp/OpenRCA/outputs/submissions/openrca_heuristic_phase12_pre30_full_v2.jsonl`
- report: `cmp/OpenRCA/outputs/reports/openrca_heuristic_phase12_pre30_full_v2_report.json`
- Judge 输出：
  - LA: 21.84%
  - TA: 99.26%
  - Explainability: 49.42%
  - Efficiency: 100.00%
  - Final Score: 63.38

## 复现命令

- 生成 submission：

```bash
cd cmp/OpenRCA
/Users/hechenyu/projects/AIOPS/.venv/bin/python AIOpsChallenge_Adapt/run_openrca_heuristic_and_build_submission.py \
  --phase phase1 \
  --pkls-dir ../CausalRCA/data_aiops/phase1_pre30/pkls \
  --input-json ../../data/phaseone-main/input.json \
  --gt-jsonl ../../AIOpsChallengeJudge/ground_truth_phase1.jsonl \
  --out-jsonl ./outputs/submissions/openrca_heuristic_phase1_pre30_smoke20.jsonl \
  --limit 20
```

- 离线评测（避免联网拉模型）：

```bash
cd cmp/OpenRCA
SNAP=~/.cache/huggingface/hub/models--sentence-transformers--paraphrase-multilingual-MiniLM-L12-v2/snapshots/86741b4e3f5cb7765a600d3a3d55a0f6a6cb443d
TRANSFORMERS_OFFLINE=1 AIOPS_SENTENCE_MODEL="$SNAP" \
  /Users/hechenyu/projects/AIOPS/.venv/bin/python ../../AIOpsChallengeJudge/evaluate.py \
  --ground-truth ../../AIOpsChallengeJudge/ground_truth_phase1.jsonl \
  --submission ./outputs/submissions/openrca_heuristic_phase1_pre30_smoke20.jsonl
```
